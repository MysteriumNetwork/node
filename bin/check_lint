#!/bin/bash

# Run code Linter for project packages
#
# Usage:
#> bin/check_lint [packages ...]
#
# Examples:
#> bin/check_lint
#> bin/check_lint .
#> bin/check_lint ./...
#> bin/check_lint ./communication
#> bin/check_lint ./communication/...

ARGUMENTS=$@
if [ -z "$ARGUMENTS" ]; then
    # By default, disable checks packages that are declared as not-cleared
    ARGUMENTS=`
        go list ./... \
        | grep -v "github.com/mysterium/node/cmd" \
        | grep -v "github.com/mysterium/node/identity" \
        | grep -v "github.com/mysterium/node/tequilapi" \
        | grep -v "github.com/mysterium/node/session" \
        | grep -v "github.com/mysterium/node/service_discovery/dto" \
        | grep -v "github.com/mysterium/node/server/dto" \
        | grep -v "github.com/mysterium/node/openvpn" \
        | grep -v "github.com/mysterium/node/nat" \
        | grep -v "github.com/mysterium/node/money" \
        | grep -v "github.com/mysterium/node/ip" \
        | grep -v "github.com/mysterium/node/location"
    `
fi

golint --set_exit_status --min_confidence=1 ${ARGUMENTS}
